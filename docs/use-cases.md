# Сценарии использования.

## Настройка системы:

Пререквизиты и инструкцию по установке и настройке см. в [readme.md](../readme.md).

* На [Amazon S3](https://aws.amazon.com/s3/) создаем ведро с нужными IAM аккаунтами с нужными ролями.
https://aws.amazon.com/s3/storage-classes/?nc=sn&loc=3#Infrequent_access.
* Идешь на машину, с которой будешь работать.
* Убеждаешься, что есть нужные зависимости.
* Ставишь на машину приложение.
* Создаешь конфиг из [этого шаблона](https://github.com/Dzenly/db-presets/blob/master/cfg/cfg-template.js)
* Указываешь путь к этому файлу в системной переменной DBP_ENV_VARS_PATH
* `npm i -g db-presets` для работы как с cmd line утилитой. Или `npm i -D db-presets` если планируете юзать для тестов.
* `db-p key-gen` - генеришь ключ шифрования.

## Стягивание пресетов для работы

`db-p get only=preset1,preset2`

## Добавление пресета.

* Каким-то образом накатываем начальный пресет, возможно чистый.
* Работаем в приложении, заполняем пресет.
* `db-p add ...`

## Редактирование пресета.

* `db-p select ...` для переключения на нужный пресет.
* Дальше редактируем его скриптами или руками в GUI.
* `db-p set-lock ...`.
* `db-p update ...`

## Воркфлоу для автотестов

* Подключаем db-presets к проекту.
* Выполняем накат пресета через API.

## Если с пресетом накосячили

* Можно зайти на Amazon S3 и восстановить пресет из бэкапов
(хранятся 10 дней, создаются каждый раз при обновлении существующего пресета).

## Смена ветки.

* Меняешь ветку, пересобираешь приложение.
* Меняешь переменные окружения.
* Делаешь db-p init.
* Дальше `db-p get ...` и продолжаешь работать с новой веткой.
