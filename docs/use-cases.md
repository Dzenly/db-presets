# Сценарии использования.

## Настройка системы:

Пререквизиты и инструкцию по установке и настройке см. в [readme.md](../readme.md).

* На [Amazon S3](https://aws.amazon.com/s3/) создаем ведро с нужными IAM аккаунтами с нужными ролями.
https://aws.amazon.com/s3/storage-classes/?nc=sn&loc=3#Infrequent_access.
* Идешь на машину, с которой будешь работать.
* Убеждаешься, что есть нужные зависимости.
* Ставишь на машину приложение.
* Создаешь конфиг из [этого шаблона](https://github.com/Dzenly/db-presets/blob/master/cfg/cfg-template.js)
* Указываешь путь к этому файлу в системной переменной DBP_ENV_VARS_PATH
* `npm i -g db-presets` для работы как с cmd line утилитой. Или `npm i -D db-presets` если планируете юзать для тестов.
* `db-p key-gen` - генеришь ключ шифрования.

## Стягивание пресетов для работы

`db-p get only=preset1,preset2`

## Добавление пресета.

`db-p add ` 

## Нужно подправить конкретный пресет для конкретного репозитория и конкретной ветки.

* db-p get include=my-preset



## Начало работы. Создание ведра на S3, создание и сохранение пресетов



* Запускаем приложение с нужным пресетом (м.б. с пустым), работаем с приложением, заполняя нужный пресет.

* Придумываем имя пресету, и сохраняем его в Amazon S3.

* И так мы создаем несколько пресетов.

## Воркфлоу для ручного тестирования

* Стягиваете на тестовую машину семейство нужных пресетов (делается одной командой).

* Устанавливаете один нужный пресет.

* Тестируете.

* Устанавливаете другой пресет.

* Тестируете. И т.д.

## Воркфлоу для автотестов

* В CI систему, перед запуском автотестов вставляем скрипт, стягивающий семейство нужных пресетов 

* Используя CMD Line или API - подменяете пресеты и рестартуете приложение прямо из тестов.

## Если с пресетом накосячили

Можно зайти на Amazon S3 и восстановить пресет из бэкапов
(хранятся 10 дней, создаются каждый раз при обновлении существующего пресета).


Смена ветки.


API

npm i локально.

npx

